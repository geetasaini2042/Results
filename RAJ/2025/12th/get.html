<!DOCTYPE html>
<html>
<head>
    <title>Result Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 40px; }
        table {
            border-collapse: collapse; margin: 20px auto; width: 90%; max-width: 1000px;
        }
        th, td {
            border: 1px solid #ccc; padding: 8px; text-align: center;
        }
        th {
            background-color: #007bff; color: white;
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }
        .fail { color: red; font-weight: bold; }
    </style>
</head>
<body>

<h2>Board Examination Result - 2025</h2>
<div id="schoolName"></div>
<div id="resultArea"></div>
<div id="error" style="color:red;"></div>

<script>
async function fetchSingleResult(roll) {
    const url = `https://www.fastresult.in/board-results/rajresultapi12/api/get-12th-result?tag=raj_10th_result&roll_no=${roll}&year=2025&wb_id=89&source=1`;
    try {
        const res = await fetch(url);
        const data = await res.json();
        return data.status === "success" ? data.data.board_result : null;
    } catch {
        return null;
    }
}

function renderResult(data) {
    document.getElementById("schoolName").innerHTML = `<h3>${data.candidate_info["School Name"]}</h3>`;

    let html = `<table><thead><tr><th>Subject</th><th>Theory</th><th>Sessional</th><th>Total</th></tr></thead><tbody>`;
    data.subjects.forEach(sub => {
        if (!sub.subject_name || sub.subject_name.trim() === "") return;
        const total = sub.subject_marks || "";
        const cls = total.includes("F") ? "fail" : "";
        html += `<tr>
            <td>${sub.subject_name}</td>
            <td>${sub.theory_1 || ""}</td>
            <td>${sub.seassional || ""}</td>
            <td class="${cls}">${total}</td>
        </tr>`;
    });
    html += `</tbody></table>`;

    html += `<p><strong>Total Marks:</strong> ${data.result["Total Marks"]} | <strong>Result:</strong> <span class="${data.result["Result"] === "Failed" ? "fail" : ""}">${data.result["Result"]}</span></p>`;

    document.getElementById("resultArea").innerHTML = html;
}

window.onload = async function () {
    const params = new URLSearchParams(window.location.search);
    const roll = params.get("roll_no");

    if (!roll) {
        document.getElementById("error").innerText = "Roll number not provided in URL.";
        return;
    }

    const data = await fetchSingleResult(roll);
    if (!data) {
        document.getElementById("error").innerText = `No result found for roll no ${roll}`;
        return;
    }

    renderResult(data);
};
</script>

</body>
</html>
